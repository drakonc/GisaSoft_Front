
<div>
  <!-- Page Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800">{{ title() }}</h1>
    <p class="text-gray-500 mt-1">
      @if (user()) {
        Actualice los detalles del usuario a continuación.
      } @else {
        Complete el formulario para registrar un nuevo usuario.
      }
    </p>
  </div>

  <!-- Form Card -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-100">
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
      <!-- Card Body -->
      <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- User Name -->
        <div class="md:col-span-2">
          <label for="userName" class="block text-sm font-medium text-gray-700 mb-1">Nombre Completo</label>
          <input type="text" id="userName" formControlName="name" class="block w-full px-3 py-2 bg-white border rounded-md shadow-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                 [class.border-red-500]="f.name.touched && f.name.invalid" 
                 [class.border-gray-300]="!f.name.touched || f.name.valid">
          @if (f.name.touched && f.name.invalid) {
            <p class="mt-1 text-xs text-red-600">El nombre es obligatorio.</p>
          }
        </div>

        <!-- Email -->
        <div class="md:col-span-2">
          <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Correo Electrónico</label>
          <input type="email" id="email" formControlName="email" class="block w-full px-3 py-2 bg-white border rounded-md shadow-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                 [class.border-red-500]="f.email.touched && f.email.invalid" 
                 [class.border-gray-300]="!f.email.touched || f.email.valid">
          @if (f.email.touched && f.email.errors?.['required']) {
            <p class="mt-1 text-xs text-red-600">El email es obligatorio.</p>
          }
          @if (f.email.touched && f.email.errors?.['email']) {
            <p class="mt-1 text-xs text-red-600">Introduzca un email válido.</p>
          }
        </div>

        <!-- Role -->
        <div>
          <label for="role" class="block text-sm font-medium text-gray-700 mb-1">Rol</label>
          <select id="role" formControlName="roleId" class="block w-full px-3 py-2 bg-white border rounded-md shadow-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                  [class.border-red-500]="f.roleId.touched && f.roleId.invalid" 
                  [class.border-gray-300]="!f.roleId.touched || f.roleId.valid">
            <option [ngValue]="null" disabled>Seleccione un rol</option>
            @for(role of roles(); track role.id) {
              <option [ngValue]="role.id">{{ role.name }}</option>
            }
          </select>
           @if (f.roleId.touched && f.roleId.invalid) {
            <p class="mt-1 text-xs text-red-600">Debe seleccionar un rol.</p>
          }
        </div>
        
        <!-- Location -->
        <div>
          <label for="location" class="block text-sm font-medium text-gray-700 mb-1">Sede</label>
          <select id="location" formControlName="locationId" class="block w-full px-3 py-2 bg-white border rounded-md shadow-sm text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                  [class.border-red-500]="f.locationId.touched && f.locationId.invalid" 
                  [class.border-gray-300]="!f.locationId.touched || f.locationId.valid">
            <option [ngValue]="null" disabled>Seleccione una sede</option>
            @for(location of locations(); track location.id) {
              <option [ngValue]="location.id">{{ location.name }}</option>
            }
          </select>
           @if (f.locationId.touched && f.locationId.invalid) {
            <p class="mt-1 text-xs text-red-600">Debe seleccionar una sede.</p>
          }
        </div>
        
        <!-- Status -->
        <div class="md:col-span-2">
            <label class="text-sm font-medium text-gray-700">Estado</label>
            <div class="mt-2 flex items-center gap-x-6">
                <div class="flex items-center">
                    <input id="status-active" value="active" type="radio" formControlName="status" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500">
                    <label for="status-active" class="ml-2 block text-sm text-gray-900">Activo</label>
                </div>
                <div class="flex items-center">
                    <input id="status-inactive" value="inactive" type="radio" formControlName="status" class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500">
                    <label for="status-inactive" class="ml-2 block text-sm text-gray-900">Inactivo</label>
                </div>
            </div>
        </div>
      </div>
      
      <!-- Card Footer -->
      <div class="flex items-center p-4 border-t border-gray-200 rounded-b justify-end space-x-3">
          <button (click)="cancel.emit()" type="button" class="py-2.5 px-5 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100">Cancelar</button>
          <button type="submit" class="text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center disabled:opacity-50" [disabled]="!userForm.valid">
            {{ user() ? 'Actualizar Usuario' : 'Guardar Usuario' }}
          </button>
      </div>
    </form>
  </div>
</div>
